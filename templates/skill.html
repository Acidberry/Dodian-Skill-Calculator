<!DOCTYPE html>
<html>
<head>
    <title>{{ skill.name }} Calc</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="window-container">
        <div class="header-bar">{{ skill.name }}{{' (Altar)' if skill.name=='Prayer' else ''}}</div>
        <div style="text-align: center; padding: 20px;">
            <form method="post" id="calcForm" class="calc-form">
                <input type="text" name="current_level" id="current_level" placeholder="Current Level" value="{{ result.current_level }}">
                <input type="text" name="target_level" id="target_level" placeholder="Target Level" value="{{ result.target_level }}">
                <input type="text" name="current_xp" id="current_xp" placeholder="Current XP" value="{{ result.current_xp }}">
                <input type="text" name="target_xp" id="target_xp" placeholder="Target XP" value="{{ result.target_xp }}">
            
				<input type="{{ 'text' if skill.name=='Prayer' else 'hidden' }}" id="fr_lvl" name="fr_lvl" placeholder="Firemaking Level" value="{{ result.fr_lvl }}">
                <input type="hidden" name="active_pair" id="active_pair" value="">
            
                <button type="submit">Calculate</button>
            </form>
            <script>
                const lvlInputs = [document.getElementById('current_level'), document.getElementById('target_level')];
                const xpInputs = [document.getElementById('current_xp'), document.getElementById('target_xp')];
                const activePairField = document.getElementById('active_pair');

                lvlInputs.forEach(input => {
                    input.addEventListener('input', () => {
                        activePairField.value = '1'; // level pair
                    });
                });

                xpInputs.forEach(input => {
                    input.addEventListener('input', () => {
                        activePairField.value = '2'; // XP pair
                    });
                });
				
				const input = document.getElementById('fr_lvl');
				if (input) {
					input.addEventListener('input', () => {
						activePairField.value = '1'; // XP pair
					});
				}
            </script>

            {% if result %}
                {% if 'error' in result %}
                <div style="margin-top: 20px; color: red; font-size: 0.8em; text-align: left;">
                    <p>{{ result.error }}</p>
                </div>
                {% else %}
                <div class="actions-table">
					<div class="action-row">
                            <span>Level</span>
                            <span>Action</span>
                            <span>Exp</span>
                            <span>Number</span>
                        </div>
                    {% for action, count, newXp in zipped %}
                        <div class="action-row">
                            <span
                                style="background-color: {{ 'red' if action.level > result.current_level else 'green' }};">
                                {{ action.level }}
                            </span>
							<div class="action-row2">
                            <img src="{{ url_for('static', filename='icons/' + action.image) }}" style="width: 50px;">
                            <span>{{ action.action }}</span>
                            </div>
							<span>Exp:{{ newXp }}</span>
                            <span>Number:{{ count }}</span>
                        </div>
                    {% endfor %}
                </div>
                {% endif %}
            {% endif %}
            
            <a href="/" style="color: #aaaaaa; font-size: 0.7em; display: block; margin-top: 20px;">‚Üê Back</a>
        </div>
    </div>
</body>

</html>